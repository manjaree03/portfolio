const projects = [
    {
        "id": 1,
        "projectYear": 2024,
        "name": "Youtube Channel - DSA tutorial",
        "description": "YouTube channel where I teach Java-based DSA concepts to strengthen foundational understanding.",
        "thumbnail": "../res/youtube_proj.png",
        "category": "windowApp",
        "tags": ["Java", "DSA", "Theory", "Logic Building"],
        "link": "https://github.com/AkashSingh1505/ACash-Bank-Software",
        "images": [
            "../res/bank_sc1.png",
            "../res/bank_sc2.png",
            "../res/bank_sc3.png",
            "../res/bank_sc4.png",
            "../res/bank_sc4.png",
            "../res/bank_sc6.png",

        ],
        "videos": [
            {
                "url": "https://www.youtube.com/@manjaree_agrawal",
                "mute": true,
                "loop": true,
                "autoPlay": true
            }
        ]
    },

    {
        "id": 3,
        "projectYear": 2023,
        "name": "Background Location Service with Activity Recognition",
        "description": "A powerful Android library providing seamless background location services with dynamic interval adjustments based on user activities like 'Still,' 'Walk,' 'Run,' and 'Vehicle,' optimizing performance and battery usage. This Android library is designed for developers seeking reliable background operation and flexible configuration.",
        "thumbnail": "../res/locationService_thumbnail.png",
        "category": "android",
        "tags": ["Android Library", "Background Service", "Activity Recognition", "Location Service"],
        "link": "https://github.com/AkashSingh1505/Location_BG_service_with_ARF",
        "images": [
            "../res/location_sc2.png",
            "../res/location_sc1.png",
        ],
        "videos": [
            {
                "url": "https://github.com/AkashSingh1505/Location_BG_service_with_ARF/assets/139606462/2d0c38f2-390f-452a-8351-c39993185245",
                "mute": true,
                "loop": true,
                "autoPlay": true
            }
        ]
    },

    {
        "id": 2,
        "projectYear": 2022,
        "name": "E-Commerce Website - Admin and User Interface",
        "description": "A modern e-commerce platform designed for seamless online shopping and secure transactions. \n\n- Features product browsing, cart management, and smooth checkout experiences. \n- Built with scalable backend architecture to handle high traffic and real-time updates. \n- Optimized for performance, usability, and future business growth.",
        "thumbnail": "../res/e_commerce_proj.png",
        "category": "windowApp",
        "tags": ["Java", "HTML", "CSS", "MySQL", "Javascript"],
        "link": "https://github.com/manjaree03/Manjaree-E-commerce-Website",
        "images": [
            "../res/atm_sc1.png",
            "../res/atm_sc2.png",
            "../res/atm_sc3.png"

        ],
        "videos": [
            {
                "url": "https://github.com/AkashSingh1505/ACash-Bank-Software/assets/139606462/1d567e9b-9b48-4188-91e2-b9cc41ef5149",
                "mute": true,
                "loop": true,
                "autoPlay": true
            }
        ]
    },

    {
        "id": 5,
        "projectYear": 2023,
        "name": "Coffee Restaurant Responsive Website",
        "description": "Personal portfolio website built with HTML, CSS & JavaScript. Rich Visual Layout, Responsive & Static Site & Fully open-sourced on GitHub - providing a foundation for future enhancements and customization.",
        "thumbnail": "../res/restaurant_proj.png",
        "category": "webApp",
        "tags": ["Web App","Java", "Html", "CSS", "Javascript", "Thymeleaf", "Bootstrap", "JQuery"],
        "link": "https://github.com/manjaree03/Coffee-Restraunt-Website-Responsive",
        "images": [
            "../res/excel_sc3.png",
           "../res/excel_sc1.png",
           "../res/excel_sc2.png",

        ],
        "videos": null
    },

    {
        "id": 4,
        "projectYear": 2025,
        "name": "AKMA Elite Adversitement & Designing Sudio",
        "description": "Built a full-stack marketing and design platform using Java, Spring Boot, Hibernate, and MySQL to deliver SEO services and customizable design products. Implemented a catalog-based e-commerce system with REST APIs for design selection, customization, cart management, and online payments. Designed a secure order processing workflow with authentication, transactional data handling, and payment gateway integration.",
        "thumbnail": "../res/akma_proj.png",
        "category": "webApp",
        "tags": ["Java", "Spring", "Springboot", "Spring Security", "JWT Authentication", "Thymeleaf", "HTML", "CSS", "Javascript", "MySQL"],
        "link": "https://github.com/manjaree03/AKMAadvertisements",
        "images": [
            "../res/akma_proj.png",
        ],
        "videos": null
    },

    {
        "id": 6,
        "projectYear": 2023,
        "name": "Fesh Idea - Entrepreneur Connect - Share Idea",
        "description": "A scalable community platform that allows entrepreneurs to create profiles, share ideas, form groups, and collaborate in real time. Built with a focus on user engagement, secure access, and structured discussions to support meaningful entrepreneurial collaboration.",
        "thumbnail": "../res/freshidea_proj.png",
        "category": "website",
        "tags": ["HTML", "CSS", "JavaScript", "Responsive Design", "Amazon Clone", "UI Replica"],
        "link": "https://github.com/manjaree03/Fresh-Idea-Entrepreneur/tree/main",
        "images": [
            "../res/amazon_sc1.png",
        ],
        "videos": null
    },
    {
        "id": 7,
        "projectYear": 2022,
        "name": "Newspaper-Headlines-Worldwide",
        "description": "A platform where People can gather and share updates on || What's going around them? || It's a dummy website made during my web development training. It is made in Html, css, javascript. the idea of making it was that people could come and post the happening taking place around them to keep everyone else updated in the community.",
        "thumbnail": "../res/newsline_proj.png",
        "category": "website",
        "tags": ["Html", "Css", "Javascript", "Responsive"],
        "link": "https://github.com/manjaree03/Newspaper-Headlines-Worldwide",
        "images": null,
        "videos": [
            {
                "url": "https://github.com/user-attachments/assets/da0e4c2f-cc5a-4c98-bdba-243e1481e181",
                "mute": true,
                "loop": true,
                "autoPlay": true
            }
        ]
    },
    {
        "id": 8,
        "projectYear": 2022,
        "name": "HiCare",
        "description": "HiCare, India's top pest control service provider, needed to digitize their audit process to improve efficiency. I developed a Kotlin-based Android app that transformed their workflow, boosting audit capacity from 1-2 to 10-15 audits per day, leading to an 86% increase in productivity and significantly enhancing client satisfaction.",
        "thumbnail": "../res/hicare_thumbnail.png",
        "category": "android",
        "tags": ["Android - Kotlin", "Best Practices", "Pest Control", "Big Audience"],
        "link": "https://play.google.com/store/apps/details?id=com.hicare.audit2",
        "images": [
            "../res/hicare_sc1.png",
        ],
        "videos": null
    },
    {
        "id": 9,
        "projectYear": 2022,
        "name": "Static Web Application",
        "description": "Developed for a client in the healthcare industry, Aarogyahat is a comprehensive Android application built using Kotlin. The platform offers a wide range of services, including health insurance management, medical diagnostics, telemedicine consultations, and wellness programs. Integrated with HealthConnect, Aarogyahat provides personalized health insights and enables users to manage their health effectively.",
        "thumbnail": "../res/staticweb_proj.png",
        "category": "website",
        "tags": ["html", "css", "javascript"],
        "link": "https://github.com/manjaree03/Static-Web-Application/tree/main",
        "images": [
            "../res/aarogyahaat_sc1.png",
            "../res/aarogyahaat_sc2.png",
            "../res/aarogyahaat_sc3.png",
        ],
        "videos": null
    },
    {
        "id": 10,
        "projectYear": 2024,
        "name": "JWT Authentication",
        "description": "Developed a robust JWT authentication system using Spring Boot and Java, demonstrating best practices in securing REST APIs. This project includes comprehensive implementation of JWT-based authentication with database connectivity for user management. Key features include secure token generation, validation, and integration with a relational database for user credentials and roles. This project showcases advanced proficiency in Spring Boot and Java, adhering to modern security practices.",
        "thumbnail": "../res/jwtAuth_thumbnail.png",
        "category": "Backend",
        "tags": ["Spring Boot", "Spring Security", "Java", "JWT Authentication", "Database Connectivity"],
        "link": "https://github.com/manjaree03/JWT-Authentication-sb-3.0",
        "images": null,
        "videos":  null
    },
    {
        "id": 11,
        "projectYear": 2022,
        "name": "Java Data Structures & Algorithms",
        "description": "Dive into a meticulously crafted repository showcasing foundational algorithms and core Java concepts. This project highlights essential data structures and dynamic programming (DP) problems, offering detailed implementations and insights into both Java programming and algorithmic problem-solving. Designed to enhance your understanding of key concepts and improve coding proficiency, it features practical examples and solutions for a wide range of famous algorithms and data structures. Ideal for learners and developers seeking to master the fundamentals and apply them effectively in real-world scenarios.",
        "thumbnail": "../res/dsa_thumbnail.png",
        "category": "Education",
        "tags": [
            "Java",
            "Array",
            "Stack",
            "LinkedList",
            "ArrayList",
            "Recursion",
            "Queue",
            "Tree",
            "Graph",
            "Sorting Algorithms",
            "Searching Algorithms",
            "Compression Algorithms",
            "Dynamic Programming",
            "Greedy Algorithms"
        ],
        "link": "https://github.com/manjaree03/DSA_basic-advanced_algos_and_Java_core_concept_Impl",
        "images": null,
        "videos": null
    },
    {
        "id": 12,
        "projectYear": 2024,
        "name": "Portfolio",
        "description": "To effectively showcase your projects, skills, and achievements, I developed a portfolio website that digitizes and presents your professional journey in a modern, engaging way. This platform is designed to offer a comprehensive view of your work, including detailed project overviews, skill highlights, and notable achievements. Leveraging advanced web technologies, the website ensures a responsive experience and serves as a dynamic tool for potential collaborations and opportunities.",
        "thumbnail": "../res/portfolio_thumbnail.png",
        "category": "website",
        "tags": [
            "Portfolio",
            "Web Development",
            "HTML",
            "CSS",
            "JavaScript",
            "Responsive Design"
        ],
        "link": "https://github.com/AkashSingh1505/portfolio",
        "images": [
           "../res/portfolio_sc1.png",
           "../res/portfolio_sc2.png",
           "../res/portfolio_sc3.png",

        ],
        "videos": null
    }



















    // Add more project objects as needed
];



// Function to get query parameters from the URL
function getQueryParam(param) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(param);
}

// Function to open project details (from the main page)
function openProjectDetail(projectId,pathname) {
    // Navigate to the project details page with the projectId as a URL parameter
    window.location.href = `${pathname}projectDetails.html?projectId=${projectId}`;
}

function updateElementContent(elementId, data, prefix = '') {
    const element = document.getElementById(elementId);

    if (data) {
        element.textContent = `${prefix}${data}`;
        element.style.display = ''; // Ensure the element is visible
    } else {
        element.style.display = 'none'; // Hide the element
    }
}

function setThumbnail(impPath){
    const element = document.getElementById('project-thumbnail');
    if (!element) return;
    element.src = impPath;
}

function getSelectedMockupStyle() {
    const key = 'mockupStyle';
    const saved = window.localStorage ? localStorage.getItem(key) : null;
    const allowed = new Set(['laptop-minimal', 'browser']);
    // Migrate old values to the new default.
    if (saved === 'laptop' || saved === 'phone') return 'laptop-minimal';
    if (saved && allowed.has(saved)) return saved;
    return 'laptop-minimal';
}

function saveSelectedMockupStyle(style) {
    const key = 'mockupStyle';
    try {
        if (window.localStorage) localStorage.setItem(key, style);
    } catch (e) {
        // ignore
    }
}

function pickProjectImageBgPair(project, idx) {
    // Dark + light shade combos (solid-looking but richer)
    const palette = [
        { light: '#FEE2E2', dark: '#B91C1C' }, // red
        { light: '#F3F4F6', dark: '#111827' }, // black
        { light: '#FFFFFF', dark: '#E5E7EB' }, // white
        { light: '#FEF3C7', dark: '#B45309' }, // yellow
        { light: '#DBEAFE', dark: '#1D4ED8' }, // blue
        { light: '#FCE7F3', dark: '#BE185D' }, // pink
        { light: '#DCFCE7', dark: '#166534' }  // green
    ];
    const seed = (Number(project?.id) || 0) + (idx || 0) * 7;
    return palette[Math.abs(seed) % palette.length];
}

function initAllProjectsMockupSelector() {
    const select = document.getElementById('mockup-style-all');
    if (!select) return;
    if (select.dataset.bound) return;

    select.value = getSelectedMockupStyle();
    select.dataset.bound = 'true';

    select.addEventListener('change', () => {
        const next = select.value;
        saveSelectedMockupStyle(next);
        filterProjects('all');
    });
}

function createMockupNode(style, imageUrl, altText, isLarge = false) {
    if (style === 'browser') {
        const wrapper = document.createElement('div');
        wrapper.className = 'browser-mockup';

        const top = document.createElement('div');
        top.className = 'browser-mockup__topbar';
        top.setAttribute('aria-hidden', 'true');

        const dots = document.createElement('div');
        dots.className = 'browser-mockup__dots';

        const dotR = document.createElement('div');
        dotR.className = 'browser-mockup__dot browser-mockup__dot--red';
        const dotY = document.createElement('div');
        dotY.className = 'browser-mockup__dot browser-mockup__dot--yellow';
        const dotG = document.createElement('div');
        dotG.className = 'browser-mockup__dot browser-mockup__dot--green';

        dots.appendChild(dotR);
        dots.appendChild(dotY);
        dots.appendChild(dotG);

        const url = document.createElement('div');
        url.className = 'browser-mockup__url';

        top.appendChild(dots);
        top.appendChild(url);

        const content = document.createElement('div');
        content.className = 'browser-mockup__content';

        const img = document.createElement('img');
        img.className = 'browser-mockup__img';
        img.src = imageUrl;
        img.alt = altText || 'Project screenshot';

        content.appendChild(img);
        wrapper.appendChild(top);
        wrapper.appendChild(content);
        return wrapper;
    }

    // default: laptop (minimal is the default style)
    const wrapper = document.createElement('div');
    wrapper.className = 'laptop-mockup';
    if (isLarge) wrapper.classList.add('laptop-mockup--lg');
    // Treat any non-browser style as laptop-minimal.
    wrapper.classList.add('laptop-mockup--minimal');

    const screen = document.createElement('div');
    screen.className = 'laptop-mockup__screen';

    const img = document.createElement('img');
    img.className = 'laptop-mockup__img';
    img.src = imageUrl;
    img.alt = altText || 'Project screenshot';

    const base = document.createElement('div');
    base.className = 'laptop-mockup__base';
    base.setAttribute('aria-hidden', 'true');

    screen.appendChild(img);
    wrapper.appendChild(screen);
    wrapper.appendChild(base);
    return wrapper;
}

function createBrowserVideoMockup(videoUrl, titleText) {
    const wrapper = document.createElement('div');
    wrapper.className = 'browser-mockup';

    const top = document.createElement('div');
    top.className = 'browser-mockup__topbar';
    top.setAttribute('aria-hidden', 'true');

    const dots = document.createElement('div');
    dots.className = 'browser-mockup__dots';

    const dotR = document.createElement('div');
    dotR.className = 'browser-mockup__dot browser-mockup__dot--red';
    const dotY = document.createElement('div');
    dotY.className = 'browser-mockup__dot browser-mockup__dot--yellow';
    const dotG = document.createElement('div');
    dotG.className = 'browser-mockup__dot browser-mockup__dot--green';

    dots.appendChild(dotR);
    dots.appendChild(dotY);
    dots.appendChild(dotG);

    const url = document.createElement('div');
    url.className = 'browser-mockup__url';

    top.appendChild(dots);
    top.appendChild(url);

    const content = document.createElement('div');
    content.className = 'browser-mockup__content';

    const iframeElement = document.createElement('iframe');
    iframeElement.className = 'browser-mockup__iframe';
    iframeElement.width = '100%';
    iframeElement.height = '100%';
    iframeElement.src = videoUrl;
    iframeElement.title = titleText || "Project video";
    iframeElement.frameBorder = "0";
    iframeElement.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share";
    iframeElement.allowFullscreen = true;

    content.appendChild(iframeElement);
    wrapper.appendChild(top);
    wrapper.appendChild(content);
    return wrapper;
}

function renderProjectDetailsImages(project, style) {
    const thumbContainer = document.getElementById('project-thumbnail-container');
    if (thumbContainer) {
        thumbContainer.innerHTML = '';
        const heroUrl = project.images != null ? project.images[0] : project.thumbnail;
        thumbContainer.appendChild(createMockupNode(style, heroUrl, 'Project preview', true));
    }

    if (project.images) {
        const imagesContainer = document.getElementById('project-images');
        if (imagesContainer) {
            imagesContainer.innerHTML = '';
            project.images.forEach(imageUrl => {
                imagesContainer.appendChild(createMockupNode(style, imageUrl, 'Project screenshot'));
            });
        }
    }
}



function setLinkText(link) {
    // Define the text for different types of links
    const websiteText = "Visit Website";
    const playStoreText = "Open on Play Store";
    const githubText = "Go to Github";

    // Set the link text
    const linkTextElement = document.getElementById('link-text');
    if (link.includes("play.google.com")) {
        setLiveIndicator(true);
        linkTextElement.textContent = playStoreText;
    } else if(link.includes("github.com")) {
        setLiveIndicator(false);
        linkTextElement.textContent = githubText;
    }else{
        setLiveIndicator(true);
        linkTextElement.textContent = websiteText;
    }

    linkTextElement.href = link;

}

function setLiveIndicator(isLive){
    const liveIndicatorElement = document.getElementById('live-indicator');
    if (isLive) {
        liveIndicatorElement.classList.add('live');
    } else {
        liveIndicatorElement.style.display = 'none';
    }
}

function loadHomePage(){
    const container = document.getElementById('feature-project');
    container.innerHTML = '';
    let filteredProjects = projects.filter(project => project.link.includes("github.com"));
    let count = 0;

    const normalizeAssetPath = (p) => (p || "").replace(/^\.\.\//, "");

    filteredProjects.forEach((project, idx) => {
        if(count>=4){
            return;
        }
        const card = document.createElement('div');
        card.className = 'card feature-card';
        card.dataset.projectId = project.id;

        // Featured badge
        const badge = document.createElement('div');
        badge.className = 'star-icon';
        const badgeImg = document.createElement('img');
        badgeImg.src = 'res/featured_icon.png';
        badgeImg.alt = 'Featured';
        badge.appendChild(badgeImg);

        // Image area with colorful background + mockup
        const imgArea = document.createElement('div');
        imgArea.className = 'feature-card__imgArea';
        const bg = pickProjectImageBgPair(project, idx);
        imgArea.style.setProperty('--img-bg-1', bg.light);
        imgArea.style.setProperty('--img-bg-2', bg.dark);

        // Use thumbnail for cards (screenshots list may include missing assets).
        const imageUrl = project.thumbnail
          ? normalizeAssetPath(project.thumbnail)
          : normalizeAssetPath((project.images && project.images.length > 0) ? project.images[0] : "");
        // Featured Projects: plain thumbnail (no laptop/browser mockup)
        const thumb = document.createElement('img');
        thumb.className = 'feature-card__thumb';
        thumb.src = imageUrl;
        thumb.alt = project.name || 'Project screenshot';
        thumb.loading = 'lazy';
        imgArea.appendChild(thumb);

        // Meta
        const body = document.createElement('div');
        body.className = 'card-body';

        const title = document.createElement('h5');
        title.className = 'card-title';
        title.textContent = project.name;

        const subtitle = document.createElement('p');
        subtitle.className = 'card-subtitle';
        subtitle.textContent = project.description;

        body.appendChild(title);
        body.appendChild(subtitle);

        card.appendChild(badge);
        card.appendChild(imgArea);
        card.appendChild(body);

        container.appendChild(card);
        count++

    });

      // Add click event listener to each card
     document.querySelectorAll('.card').forEach(card => {
        card.addEventListener('click', (e) => {
            const projectId = e.currentTarget.dataset.projectId;
            openProjectDetail(projectId,"project pages/");
        });
    });

}

// Function to load project details (from the projectDetails.html page)
function loadProjectDetails() {
    const projectId = getQueryParam('projectId');
    const project = projects.find(p => p.id == projectId);

    if (project) {
        // Set data in the HTML elements of the project detail page
        updateElementContent('project-year', project.projectYear, 'Github: ');
        updateElementContent('project-name', project.name);
        updateElementContent('project-description', project.description);
        setLinkText(project.link);

        // Mockup selector (Project Details only)
        const select = document.getElementById('mockup-style');
        const initialStyle = getSelectedMockupStyle();
        if (select && !select.dataset.bound) {
            select.value = initialStyle;
            select.dataset.bound = 'true';
            select.addEventListener('change', () => {
                const next = select.value;
                saveSelectedMockupStyle(next);
                renderProjectDetailsImages(project, next);
            });
        } else if (select) {
            select.value = initialStyle;
        }

        // Populate project tags
        if(project.tags){
            const tagsContainer = document.getElementById('project-tags');
            tagsContainer.innerHTML = ''; // Clear existing tags
            project.tags.forEach(tag => {
                const tagElement = document.createElement('div');
                tagElement.className = 'tech-item';
                tagElement.textContent = tag;
                tagsContainer.appendChild(tagElement);
            });
        }

        // Populate project images
        if(project.images){
            renderProjectDetailsImages(project, getSelectedMockupStyle());
        }else{
            document.getElementById('project-images').style.display = 'none';
            document.getElementById('image-title').style.display = 'none';
        }

        // Populate project videos
        if(project.videos){
            const videosContainer = document.getElementById('project-videos');
            videosContainer.innerHTML = ''; // Clear existing videos
            project.videos.forEach(video => {
                const url = `${video.url}?autoplay=${video.autoPlay ? 1 : 0}&mute=${video.mute ? 1 : 0}&loop=${video.loop ? 1 : 0}`;
                videosContainer.appendChild(createBrowserVideoMockup(url, "Project video"));
            });
        }else{
            document.getElementById('project-videos').style.display = 'none';
            document.getElementById('video-title').style.display = 'none';
        }

    } else {
        console.error('Project not found!');
    }
}


function renderProjects(filteredProjects) {
    const projectContainer = document.querySelector('.card-container');
    projectContainer.innerHTML = '';

    filteredProjects.forEach((project, idx) => {
        const card = document.createElement('div');
        card.className = 'card';
        card.dataset.projectId = project.id;

        // Image area only gets the solid color background
        const imgArea = document.createElement('div');
        imgArea.className = 'project-card__imgArea';
        // All Projects list: always prefer thumbnail for consistent display.
        const imageUrl = project.thumbnail ? project.thumbnail : ((project.images && project.images.length > 0) ? project.images[0] : "");
        // All Projects: show plain screenshot (no laptop/browser mockup frame)
        const thumb = document.createElement('img');
        thumb.className = 'project-card__thumb';
        thumb.src = imageUrl;
        thumb.alt = project.name || 'Project screenshot';
        thumb.loading = 'lazy';
        thumb.decoding = 'async';
        imgArea.appendChild(thumb);

        const body = document.createElement('div');
        body.className = 'card-body';

        const year = document.createElement('h5');
        year.className = 'card-Year';
        year.textContent = `Github: ${project.projectYear}`;

        const title = document.createElement('h5');
        title.className = 'card-title';
        title.textContent = project.name;

        const subtitle = document.createElement('p');
        subtitle.className = 'card-subtitle';
        subtitle.textContent = project.description;

        body.appendChild(year);
        body.appendChild(title);
        body.appendChild(subtitle);

        card.appendChild(imgArea);
        card.appendChild(body);
        projectContainer.appendChild(card);
    });

     // Add click event listener to each card
     document.querySelectorAll('.card').forEach(card => {
        card.addEventListener('click', (e) => {
            const projectId = e.currentTarget.dataset.projectId;
            openProjectDetail(projectId,"");
        });
    });


    console.log('Rendered projects:', filteredProjects);  // Debugging line
}

function filterProjects(category) {
    console.log('Filtering category:', category);  // Debugging line

    let filteredProjects;
    if (category === 'all') {
        filteredProjects = projects;
    } else {
        filteredProjects = projects.filter(project => project.category === category);
    }

    renderProjects(filteredProjects);
}

document.addEventListener('DOMContentLoaded', () => {
    // Visitor counter (GitHub Pages friendly: uses CountAPI).
    // Counts once per browser per 12 hours to avoid incrementing on internal navigation.
    (function updateFooterVisitorCount(){
        const el = document.getElementById('site-views');
        if (!el) return;

        const isLocal =
            window.location.protocol === 'file:' ||
            window.location.hostname === 'localhost' ||
            window.location.hostname === '127.0.0.1';

        const namespace = 'manjaree03.github.io';
        const key = 'total-visits';
        const storageKey = 'siteViews:lastHitAt';
        const windowMs = 12 * 60 * 60 * 1000; // 12 hours

        const now = Date.now();
        const last = Number(window.localStorage ? localStorage.getItem(storageKey) : 0) || 0;
        const shouldHit = !last || (now - last) > windowMs;

        // Local dev fallback (no external network/DNS required).
        if (isLocal) {
            try {
                const localKey = 'siteViews:localCount';
                const current = Number(localStorage.getItem(localKey) || '0') || 0;
                const next = current + 1;
                localStorage.setItem(localKey, String(next));
                el.textContent = `${next} (local)`;
            } catch (e) {
                el.textContent = 'â€”';
            }
            return;
        }

        const url = shouldHit
            ? `https://api.countapi.xyz/hit/${encodeURIComponent(namespace)}/${encodeURIComponent(key)}`
            : `https://api.countapi.xyz/get/${encodeURIComponent(namespace)}/${encodeURIComponent(key)}`;

        fetch(url)
            .then(r => r.json())
            .then(data => {
                const value = (data && typeof data.value === 'number') ? data.value : null;
                if (value == null) return;
                el.textContent = String(value);
                try {
                    if (shouldHit && window.localStorage) localStorage.setItem(storageKey, String(now));
                } catch (e) { /* ignore */ }
            })
            .catch(() => {
                // keep placeholder (likely blocked DNS/network). Local dev shows "(local)" above.
            });
    })();

    if (window.location.pathname.includes('allProjects.html')) {
        filterProjects('all');
        // Category filter menu removed; keep rendering all projects only.

    }else if(window.location.pathname.includes('skills.html')){

    }else if(window.location.pathname.includes('projectDetails.html')){
        loadProjectDetails();
    }else{
        loadHomePage();
    }

});


